---
description: 
globs: 
alwaysApply: false
---
──────────────────────────────────────────────────────────────────────────────
STACK OVERVIEW
• Next.js 14 (App Router, TypeScript “strict”)
• Tailwind CSS + shadcn/ui
• Fonts – Radley (display) · Inter (body) via @next/font
• State – React Context + Supabase Realtime (no Redux)
──────────────────────────────────────────────────────────────────────────────
PROJECT TREE
app/                    # pages & routes
├─ layout.tsx         # global fonts/providers
├─ page.tsx           # landing
└─ …                  # dashboard, products, checkout, orders, admin
components/             # stateless UI
├─ ui/ (shadcn)
├─ Navbar.tsx
├─ ProductCard.tsx
├─ CartDrawer.tsx
├─ AddressForm.tsx
├─ ProgressBar.tsx
└─ StatusChip.tsx
hooks/                  # useCart, useInventory, useRealtime
lib/                    # supabase.ts, apiClient.ts, validators.ts, constants.ts
styles/                 # globals.css → @tailwind base|components|utilities
public/                 # logo.svg, product imgs
──────────────────────────────────────────────────────────────────────────────
BRAND TOKENS (tailwind.config.js ▸ theme.extend)
colors: {
primary:"#0F3933", accent:"#97FCE4", muted:"#B0C5C1", bg:"#02231E",
soft1:"#DBFBF6", soft2:"#EDFFFC", soft3:"#F5FEFD", deep:"#193833",
white:"#FFFFFF", tealMid:"#23524C", tealBright:"#33998C",
dark1:"#072723", dark2:"#072724",
}
fontFamily: {
display:["var(--font-cormorant-garamond)","serif"],
body:["var(--font-inter)","sans-serif"],
}
──────────────────────────────────────────────────────────────────────────────
COMPONENT RULES
• One component per file, PascalCase default export.

• UI components receive props only—no direct Supabase calls.

• Interactive files start with `"use client"`.

• Build with shadcn primitives then extend via Tailwind utilities; no inline styles.

──────────────────────────────────────────────────────────────────────────────
PAGE RESPONSIBILITIES
/                  hero + live supply bar   (server)
/dashboard         catalog, cart badge, past orders (client)
/products/[slug]   gallery, size picker, add-to-cart (client)
/checkout          shipping form → payment choice  (client)
/thanks            post-payment success           (server)
/orders            realtime order tracker         (client)
/admin             founders paste Printify & stake-tx data (client)
──────────────────────────────────────────────────────────────────────────────
FORMS & VALIDATION
react-hook-form + Zod schemas in lib/validators.ts

< FormMessage > under each invalid field.

Disable submit + show spinner while awaiting API.
──────────────────────────────────────────────────────────────────────────────
ACCESSIBILITY & RESPONSIVENESS
• Breakpoints: sm 640 / md 768 / lg 1024.

• 44 px min hit area; `focus:outline-accent` util on links.

• `aria-label` on icons; `role="status"` on live inventory bar.

• CartDrawer traps focus; Esc closes.
──────────────────────────────────────────────────────────────────────────────
DATA FLOW
Reads → server components (revalidate 30 s) or Supabase Realtime.

Writes → POST/PUT to `/api/*` via apiClient.ts (typed).

No direct DB mutations in client components.
──────────────────────────────────────────────────────────────────────────────
STATE MANAGEMENT
• useCart context (optimistic add/remove).

• Inventory & order status via Realtime subscriptions.

• Avoid external state libraries until v2.
──────────────────────────────────────────────────────────────────────────────
LOADING / ERROR UX
• shadcn Skeleton if fetch >300 ms.

• ErrorBoundary per route with friendly copy.

• Toasts via shadcn ToastProvider for API failures.
──────────────────────────────────────────────────────────────────────────────
PERFORMANCE TARGETS
• LCP < 2.5 s (4 G) • CLS < 0.1 • initial JS ≤ 250 KB gz.

Run `next build --profile`, fix regressions before merge.
──────────────────────────────────────────────────────────────────────────────
TOOLING & CI
• ESLint + Prettier (pre-commit via Husky).

• GitHub Action: lint → type-check → `next build` → Vercel preview.

• Commit style: `feat:` `fix:` `chore:` `refactor:`.
──────────────────────────────────────────────────────────────────────────────
TESTING
• Jest + RTL for units.

• Playwright smoke: add-to-cart → checkout redirect.

• Run `npm run lint:a11y` (axe-core) before merge.
──────────────────────────────────────────────────────────────────────────────
LAUNCH CHECKLIST
[ ] Lighthouse ≥ 90 perf/a11y/bp

[ ] Secrets set in Vercel (.env)

[ ] Manual QA mobile + desktop

[ ] All pages render without JS (progressive enhancement)
──────────────────────────────────────────────────────────────────────────────